dellstore2=# CREATE OR REPLACE FUNCTION orders_insert_trigger()                                                                                                                                             RETURNS TRIGGER AS                                                                                                                                                                                          $$                                                                                                                                                                                                          BEGIN                                                                                                                                                                                                           IF ( NEW.orderdate >= DATE ('2004-10-01') AND NEW.orderdate < DATE ('2005-01-01') ) THEN                                                                                                                       INSERT INTO orders_2004_q4 VALUES (NEW.*);                                                                                                                                                               ELSIF ( NEW.orderdate >= DATE ('2004-07-01') AND NEW.orderdate < DATE ('2004-10-01') ) THEN                                                                                                                    INSERT INTO orders_2004_q3 VALUES (NEW.*);                                                                                                                                                               ELSIF ( NEW.orderdate >= DATE ('2004-04-01') AND NEW.orderdate < DATE ('2004-07-01') ) THEN                                                                                                                    INSERT INTO orders_2004_2 VALUES (NEW.*);                                                                                                                                                                ELSIF ( NEW.orderdate >= DATE ('2004-01-01') AND NEW.orderdate < DATE ('2004-04-01') ) THEN                                                                                                                    INSERT INTO orders_2004_q1 VALUES (NEW.*);                                                                                                                                                               ELSE                                                                                                                                                                                                    RAISE EXCEPTION 'Error in orders_insert_trigger():  date out of range';                                                                                                                                          END IF;                                                                                                                                                                                                    RETURN NULL;                                                                                                                                                                                            END;                                                                                                                                                                                                        $$ LANGUAGE plpgsql;

