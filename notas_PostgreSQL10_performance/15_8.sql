dellstore2=# CREATE OR REPLACE FUNCTION orders_insert_trigger()                                                                                                                                             RETURNS TRIGGER AS $$                                                                                                                                                                                       DECLARE                                                                                                                                                                                                     ins_sql TEXT;                                                                                                                                                                                               BEGIN                                                                                                                                                                                                       ins_sql := 'INSERT INTO orders_' || to_char(NEW.orderdate, 'YYYY') ||                                                                                                                                                  '_q' || date_part('quarter', DATE(NEW.orderdate)) ||                                                                                                                                                        '(orderid,orderdate,customerid,netamount,tax,totalamount) VALUES ' ||                                                                                                                                       '('|| NEW.orderid || ',' || quote_literal(NEW.orderdate) || ',' ||                                                                                                                                          NEW.customerid || ',' ||  NEW.netamount ||','|| NEW.tax || ',' ||                                                                                                                                           NEW.totalamount || ')';                                                                                                                                                                                                       EXECUTE ins_sql;                                                                                                                                                               RETURN NULL;                                                                                                                                                                                                END                                                                                                                                                                                                         $$ LANGUAGE plpgsql;                                                                                                                                                                                        CREATE FUNCTION

